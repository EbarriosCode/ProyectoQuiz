doctype html
html
  head    
    meta(charset='UTF-8')
    meta(name='viewport', content='width=device-width, initial-scale=1.0')
    meta(http-equiv='X-UA-Compatible', content='ie=edge')
    title= title
    //link(rel='stylesheet', href='/stylesheets/bootstrap.css')
    link(rel='stylesheet', href='/stylesheets/styleChart.css')
    //script(src='/javascripts/jquery.js')
    //script(src='/javascripts/bootstrap.js')
  body

    script(src="/javascripts/highcharts.js")
    script(src="/javascripts/highcharts-3d.js")
    script(src="/javascripts/exporting.js")

    div(id="containerBar" style="height: 400px")
    div(id="containerPie" style="height: 400px")                                                                              
    //Nav tabs
    //ul(class="nav nav-tabs nav-justified info" role="tablist")
      li(class="nav-item")
        a(class="nav-link active" data-toggle="tab" href="#panelChartBar" role="tab")
          i(class="fa fa-user") Profile
      
      li(class="nav-item")
        a(class="nav-link" data-toggle="tab" href="#panelPie" role="tab")
          i(class="fa fa-heart") Follow
        
    //Tab panels
    //div(class="tab-content")
        Panel 1
        div(class="tab-pane fade in show active" id="panelChartBar" role="tabpanel")
            br
            div(id="containerBar" style="height: 400px")
        
        Panel 2
        div(class="tab-pane fade" id="panelPie" role="tabpanel")
            br
            div(id="containerPie")                                                                              
    
    script.
      
      var resultado;

      $("#btn-resultado").click(function(){        
          getResultadoAjax();            
      });
      function getResultadoAjax()
      {
        $.ajax
        (
            {
                url : "/ResultadoFinalJuego",
                type : "GET",
                contentType: "application/json; charset=utf-8",
                //data: "{}",
                dataType: "json",
                success: function(Result){
                  //Result = Result.d;
                  var data = [];
                  var categoriasBarChart = [];
                  //console.log(Result[0][0].nombre);
                  for(var i in Result[0])
                  {
                    var serie = new Array(Result[0][i].nombre, Result[0][i].sumaCorrectas);
                    data.push(serie);

                    var nombres = new Array(Result[0][i].nombre);
                    categoriasBarChart.push(nombres);
                  }
                  //Aqui va la funcion que pinta el grafico
                  //console.log(data);
                  //console.log(categoriasBarChart);
                  PintarGraficoPie(data);
                  PintarGraficoBar(data,categoriasBarChart);
                },
                error: function(Result){
                  alert("Error Ajax "+Result);
                }                
            }
        );
      }      

      function PintarGraficoPie(series)
      {
          Highcharts.chart('containerPie', {
            chart: {
                type: 'pie',
                options3d: {
                    enabled: true,
                    alpha: 45
                }
            },
            title: {
                text: 'RESULTADO FINAL'
            },
            subtitle: {
                text: ''
            },
            plotOptions: {
                pie: {
                    innerSize: 100,
                    depth: 45
                }
            },
            //series: jsonFinal
            series: [{
                name: 'Total de Respuestas Correctas',                            
                data: series                   
            }]
        });
      }
    

      function PintarGraficoBar(series,categorias)
      {
        Highcharts.chart('containerBar', {
          chart: {
              type: 'column',
              options3d: {
                  enabled: true,
                  alpha: 10,
                  beta: 25,
                  depth: 70
              }
          },
          title: {
              text: 'RESULTADO FINAL'
          },
          subtitle: {
              text: ''
          },
          plotOptions: {
              column: {
                  depth: 25
              }
          },
          //maxColor:[#003399],
          xAxis: {
              categories: categorias,//Highcharts.getOptions().lang.shortMonths,                          
              labels: {
                  skew3d: true,
                  style: {
                      fontSize: '26px'
                  }
              }
          },
          yAxis: {
              title: {
                  text: null
              }
          },
          series: [{
                
                name: 'Total de Respuestas Correctas',            
                data: series
              
          },
          ]
        });
      }    